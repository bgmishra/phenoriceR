---
title: "RiceAtlas - Questions and proposals for processing"
output:
  html_document:
    toc: yes
    toc_depth: '2'
    highlight: haddock
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Some Questions

1. What's the difference between RiceCalendar_v1 and RiceProduction_v1 ? Which 
   should we use ? 
   
2. Is there a "legend" explaining the meaning of the different columns ? 

3. What is "Maturity" ? Can we relate it to "Heading" ? 

4. What is "seed_age" ? 

3. Where are the areas reported ? 

## Processing needed

To facilitate processing and comparison with PhenoRice results, it would be 
good if the dataset could be reshaped as follows: 

1. Remove all areas outside of the current PhenoRice analysis

2. Reshape the DB in a more "processing-friendly" format. I am thinking of something
   like this:
   
   - "Location" columns to be kept as is: `OBJECTID`, `ISO`, `COUNTRY`, `REGION`, `SUB_REGION`
   - "Location" columns to be added (if/where possible): `ISO_SUB`, corresponding to 
      the ISO code of the `SUB_REGION`
   -  Reshape the "data" columns to long format. What I'm thinking of is something on 
      these lines: 
      
      | OBJECTID | ISO  | ...  | nseas |season         | seas_cat   |pheno_var | start   | peak    | end | ricearea | totarea | ricefc |
      | :------: |:----:| :---:| :---: |:-------------:| :---------:|:--------:|:-------:|:-------:|:---:|:-------: |:-------:|:------:|
      | 1        | VNM  | ...  | 2     | Winter-spring | first      | sow      |  10     | 20      | 30  | 2500     |  5000   | 0.5    |
      | 1        | VNM  | ...  | 2     | Summer        | second     | sow      |  100    | 110     | 120 | 1000     |  5000   | 0.2    |
      | 1        | VNM  | ...  | 2     | NA            | third      | sow      |  NA     | NA      | NA  | NA       |  5000   | NA     |
      | 1        | VNM  | ...  | 2     | Winter-spring | first      | flow     |  60     | 70      | 80  | 2500     |  5000   | 0.5    |
      | 1        | VNM  | ...  | 2     | Summer        | second     | flow     |  150    | 160     | 170 | 1000     |  5000   | 0.2    |
      | 1        | VNM  | ...  | 2     | NA            | third      | flow     |  NA     | NA      | NA  | NA       |  5000   | NA     |
      | 1        | VNM  | ...  | 2     | Winter-spring | first      | harv     |  100    | 110     | 120 | 2500     |  5000   | 0.5    |
      | 1        | VNM  | ...  | 2     | Summer        | second     | harv     |  190    | 200     | 210 | 1000     |  5000   | 0.2    |
      | 1        | VNM  | ...  | 2     | NA            | third      | harv     |  NA     | NA      | NA  | NA       |  5000   | NA     |
      | 2        | VNM  | ...  | 3     | Winter-spring | first      | sow      |  15     | 25      | 35  | 2500     |  5000   | 0.5    |
      | 2        | VNM  | ...  | 3     | Summer        | second     | sow      |  105    | 115     | 125 | 1000     |  5000   | 0.2    |
      | 2        | VNM  | ...  | 3     | Off           | third      | sow      |  200    | 205     | 210 | 500      |  5000   | 0.1    |
      
      
     
   -  This could be done either manually or in `R` by importing the dataset to a
      `sf` object and then using either functionalities from `reshape2::melt` or
      `dplyr::gather`. I'd suggest the second solution, which is less error-prone
      and recyclable/reproducible (and can be modified if we decide that we need 
      something more/less/different. The function could be added to `PhenoriceR`
      package. 
      
   -  For Bhogendra: Is it possible for you to work onthis re-sahping ? 
